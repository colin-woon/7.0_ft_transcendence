# Technical Stack & Implementation Guidelines

## 1. Frontend Strategy (A)
* **Framework:** Next.js (App Router)+ TypeScript (Industry standard for SSR/BFF architecture; provides automatic routing and optimized data fetching.)
* **Build Tool:** Turbopack with SWC.
* **Package Manager:** npm (keeping it simple)
* **Styling:** Tailwind CSS (Rapid UI development).
* **Type Safety:** TypeScript (Strict Mode).
* **State Management Libraries:** Zustand (Client State) + React Query (TanStack) (Server-state)("Stale-While-Revalidate" (SWR) effect, caching and sync).
* **Pattern:** Atomic Design + Composition. Feature-Based Architecture with Colocation (AKA Domain Driven Design)
* **Formatting:** Biome (Single high-performance tool replacing ESLint and Prettier; keeps the team synchronized with zero-config overhead.)
* **Versions:** Next.js 15, Node v24, Tailwind v4

### Directory Structure (Next.js)
```yaml
frontend/src
├── app/                  # THE ROUTING LAYER (Keep this thin)
│   ├── layout.tsx        # Global shell (Providers, Navbar)
│   ├── (auth)/           # Route Group: /login, /register
│   ├── forum/            # /forum
│   │   ├── [id]/         # Dynamic route: /forum/123
│   │   └── page.tsx      
│   └── chat/             # /chat
├── features/             # THE BUSINESS LOGIC (The Heart)
│   ├── auth/             # Everything related to Auth
│   │   ├── components/   # LoginForm.tsx, UserAvatar.tsx
│   │   ├── hooks/        # useAuth.ts
│   │   └── services/     # auth-api.ts (calls Java service)
│   ├── forum/            # Everything related to Forum
│   │   ├── components/   # PostList.tsx, CommentItem.tsx
│   │   ├── store/        # forum-store.ts (Zustand)
│   └── chat/             # Everything related to Chat
│   │   ├── components/   
│   │   ├── hooks/        
│   │   └── services/     
├── components/           # SHARED UI (The Design System)
│   └── ui/               # Shadcn/ui Atoms (Button, Input, Card)
├── lib/                  # SHARED UTILS (Third-party config)
│   ├── apiClient.ts      # Axios/Fetch wrapper
│   └── biome.json        # Linter config
│           # Linter config
└── hooks/                # SHARED HOOKS (useDebounce, useMediaQuery)
```

## 2. Data Communication Standards
**Serialization Format:** JSON.
**Naming Convention**: camelCase for all API keys.
**Standard Response Wrapper**: All APIs must return a consistent structure:
```JSON
{
  "status": "success",
  "data": { ... },
  "error": null
}
```
**Type Definition:** Types are colocated within `/features` folders; shared types reside in `/src/types`.


## 3. Backend: Java Services (Auth & Chat)
* **Framework:** Quarkus (Container-first, fast startup).
* **Build Tool & Package Manager:** Maven, but managed by Quarkus CLI `quarkus extension add <package>`
* **Pattern:** Service-Repository + Anemic Domain Model.
* **Data Layer:** Hibernate ORM with Panache (Repository Pattern).
* **Validation:** Jakarta Bean Validation (Hibernate Validator).
* **Formatting:** Spotless Maven Plugin (Google Java Format).
* * **Versions:** Java 21.0.9-tem, Quarkus 3.27.1, Maven 3.9.11

### Directory Structure (Java)
```yaml
src/main/java/org/acme
├── /api           # Controllers (Strict Input/Output, HTTP only)
├── /service       # Business Logic (OAuth, Vault calls)
├── /model         # Entities (1:1 mapping with DB tables)
├── /dto           # Data Transfer Objects (Public structs)
└── /repository    # DB Access (Panache/SQL)
```

### **Libraries:**
#### Auth
#### Chat
  * quarkus-redis-client (for caching online users, typing status, read receipts, pub/sub for messaging queues, OPTIONAL mutiny for reactive programming)
  * quarkus-websockets-next (more modern, fast and easy to use, but difficult to port, but its okay since we dont plan to change frameworks)

## 4. Backend: Python Service (Forum)
* **Framework:** FastAPI (High performance, async native).
* **Package Manager** uv `uv add <package>`
* **Pattern:** Procedural/Functional (C-style logic).
* **Type Safety:** Pyright (Static) + Pydantic (Runtime).
* **ORM:** SQLAlchemy (Standard relational mapper).
* **Formatting:** Ruff (Linting + Formatting).
* **Libraries:** uvicorn (ASGI web server in C)
* * **Versions:** Python 3.13, uv 0.9.22

### Directory Structure (Python)
```yaml
forum/
├── src/
│   ├── internal/        # Utils (JWT Auth, Markdown Sanitizer)
│   ├── database.py      # DB Connection
│   ├── logic.py         # Business Logic Functions
│   ├── main.py          # Entrypoint
│   ├── models.py        # SQLAlchemy Models
│   └── schemas.py       # Pydantic Models
└── tests/               # External tests
```

## 5. Infrastructure & Data
* **Database:** PostgreSQL (Relational Data).
* **Caching:** Redis (Session storage, WebSocket Pub/Sub, Online Status).
* **Secrets:** HashiCorp Vault.

## 6. Branching & Git Strategy
**Option 1 (everyone is a Full-Stack Dev, need to make sure the feature integrates with everything, point A-Z, u learn all stacks)**
```sh
feat/[name] (Standard features - spans multiple directories)
infra/[name] (Changes to Nginx, Postgres, Redis, or Docker)
docs/[name] (Markdown and architectural updates)
refactor/[name] (Code cleanup with no logic changes)
```

**Option 2 (each person has ownership of 1 stack, need to define the shared interface/types/api design very clearly, u specialize)**
```sh
frontend/[feature_name]
auth/[feature_name]
chat/[feature_name]
forum/[feature_name]
nginx/[feature_name]
postgres/[feature_name]
redis/[feature_name]
integration
```
* **PR Rules:** Must pass Spotless/Ruff check before merge.
